<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>promethee_gamma_gui.Controllers.AppController &#8212; PROMETHEE Gamma GUI app 0.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/alabaster.css" />
    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/sphinx_highlight.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <h1>Source code for promethee_gamma_gui.Controllers.AppController</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">tkinter.messagebox</span> <span class="k">as</span> <span class="nn">msg</span>
<span class="kn">from</span> <span class="nn">tkinter</span> <span class="kn">import</span> <span class="n">filedialog</span> <span class="k">as</span> <span class="n">fd</span>
<span class="kn">from</span> <span class="nn">tkinter</span> <span class="kn">import</span> <span class="n">IntVar</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">platform</span>

<span class="kn">from</span> <span class="nn">.HelpController</span> <span class="kn">import</span> <span class="n">HelpController</span>
<span class="kn">from</span> <span class="nn">.DataTabControllers.DataTabController</span> <span class="kn">import</span> <span class="n">DataTabController</span>
<span class="kn">from</span> <span class="nn">.ResultTabControllers.ResultTabController</span> <span class="kn">import</span> <span class="n">ResultTabController</span>
<span class="kn">from</span> <span class="nn">.HelpForParametersTabControllers.HelpForParametersTabController</span> <span class="kn">import</span> <span class="n">HelpForParametersTabController</span>
<span class="kn">from</span> <span class="nn">..Models.PrometheeGamma</span> <span class="kn">import</span> <span class="n">PrometheeGamma</span>
<span class="kn">from</span> <span class="nn">..Views</span> <span class="kn">import</span> <span class="n">AppView</span><span class="p">,</span> <span class="n">SaveView</span><span class="p">,</span> <span class="n">AboutView</span>
<span class="kn">from</span> <span class="nn">..Resources.Reader</span> <span class="kn">import</span> <span class="n">Reader</span>
<span class="kn">from</span> <span class="nn">..Resources.Lock</span> <span class="kn">import</span> <span class="n">Lock</span>


<div class="viewcode-block" id="AppController"><a class="viewcode-back" href="../../../promethee_gamma_gui.Controllers.html#promethee_gamma_gui.Controllers.AppController.AppController">[docs]</a><span class="k">class</span> <span class="nc">AppController</span><span class="p">(</span><span class="n">AppView</span><span class="o">.</span><span class="n">ViewListener</span><span class="p">,</span> <span class="n">SaveView</span><span class="o">.</span><span class="n">Listener</span><span class="p">,</span> <span class="n">ResultTabController</span><span class="o">.</span><span class="n">Listener</span><span class="p">,</span> <span class="n">HelpForParametersTabController</span><span class="o">.</span><span class="n">Listener</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The main controller of the application</span>

<span class="sd">    It allows to start and stop the application, but also to make the link between its different parts</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    appView : AppView()</span>
<span class="sd">        the tkinter master frame, the root frame of the app</span>
<span class="sd">    alreadyCompute : bool</span>
<span class="sd">        a control variable to keep in memory if the results are already computed or not</span>
<span class="sd">    prometheeGamma : PrometheeGamma</span>
<span class="sd">        the model that compute results with PROMETHEE Gamma method</span>
<span class="sd">    dataTabController : DataTabController</span>
<span class="sd">        the main controller of the data tab</span>
<span class="sd">    resultTabController : ResultTabController</span>
<span class="sd">        the main controller of the result tab</span>
<span class="sd">    helpForParametersTabController : HelpForParametersTabController</span>
<span class="sd">        the main controller of the helpForParameters tab</span>
<span class="sd">    saveDict : dict</span>
<span class="sd">        the dictionnary of components that can be saved</span>
<span class="sd">    save_parentDirectory : str</span>
<span class="sd">        the parent directory to save project</span>
<span class="sd">    save_nameDirectory : str</span>
<span class="sd">        the directory name in which to save project</span>
<span class="sd">    helpController : HelpController</span>
<span class="sd">        the controller of help menu</span>
<span class="sd">    lock : Lock</span>
<span class="sd">        a lock to synchronizes different parts of the app</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">appView</span> <span class="o">=</span> <span class="n">AppView</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">appView</span><span class="o">.</span><span class="n">setListener</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alreadyCompute</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prometheeGamma</span> <span class="o">=</span> <span class="n">PrometheeGamma</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dataTabController</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">resultTabController</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">helpForParametersTabController</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">saveDict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Data&quot;</span><span class="p">:</span><span class="n">IntVar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">appView</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> 
                         <span class="s2">&quot;Results&quot;</span><span class="p">:</span><span class="n">IntVar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">appView</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> 
                         <span class="s2">&quot;Orthogonal graph&quot;</span><span class="p">:</span><span class="n">IntVar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">appView</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> 
                         <span class="s2">&quot;Rank graph&quot;</span><span class="p">:</span><span class="n">IntVar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">appView</span><span class="p">,</span> <span class="mi">1</span><span class="p">)}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_parentDirectory</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_nameDirectory</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">helpController</span> <span class="o">=</span> <span class="n">HelpController</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lock</span> <span class="o">=</span> <span class="n">Lock</span><span class="p">()</span>


<div class="viewcode-block" id="AppController.run"><a class="viewcode-back" href="../../../promethee_gamma_gui.Controllers.html#promethee_gamma_gui.Controllers.AppController.AppController.run">[docs]</a>    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Launch the app</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">appView</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="p">(</span><span class="n">dataTab</span><span class="p">,</span> <span class="n">resultTab</span><span class="p">,</span> <span class="n">helpForParametersTab</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">appView</span><span class="o">.</span><span class="n">getTabs</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">showDataTabView</span><span class="p">(</span><span class="n">dataTab</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">showResultTabView</span><span class="p">(</span><span class="n">resultTab</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">showHelpForParametersTabView</span><span class="p">(</span><span class="n">helpForParametersTab</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">appView</span><span class="o">.</span><span class="n">mainloop</span><span class="p">()</span></div>


<div class="viewcode-block" id="AppController.showDataTabView"><a class="viewcode-back" href="../../../promethee_gamma_gui.Controllers.html#promethee_gamma_gui.Controllers.AppController.AppController.showDataTabView">[docs]</a>    <span class="k">def</span> <span class="nf">showDataTabView</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">master</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Show the data tab</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        master : CTkFrame</span>
<span class="sd">            the master frame for the data tab</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dataTabController</span> <span class="o">=</span> <span class="n">DataTabController</span><span class="p">(</span><span class="n">master</span><span class="o">=</span><span class="n">master</span><span class="p">,</span> <span class="n">root</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">appView</span><span class="p">,</span> <span class="n">lock</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lock</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dataTabController</span><span class="o">.</span><span class="n">showView</span><span class="p">()</span></div>


<div class="viewcode-block" id="AppController.showResultTabView"><a class="viewcode-back" href="../../../promethee_gamma_gui.Controllers.html#promethee_gamma_gui.Controllers.AppController.AppController.showResultTabView">[docs]</a>    <span class="k">def</span> <span class="nf">showResultTabView</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">master</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Show the result tab</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        master : CTkFrame</span>
<span class="sd">            the master frame for the result tab</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">resultTabController</span> <span class="o">=</span> <span class="n">ResultTabController</span><span class="p">(</span><span class="n">master</span><span class="o">=</span><span class="n">master</span><span class="p">,</span> <span class="n">root</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">appView</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">resultTabController</span><span class="o">.</span><span class="n">setListener</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">resultTabController</span><span class="o">.</span><span class="n">showView</span><span class="p">()</span></div>


<div class="viewcode-block" id="AppController.showHelpForParametersTabView"><a class="viewcode-back" href="../../../promethee_gamma_gui.Controllers.html#promethee_gamma_gui.Controllers.AppController.AppController.showHelpForParametersTabView">[docs]</a>    <span class="k">def</span> <span class="nf">showHelpForParametersTabView</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">master</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Show the helpForParameters tab</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        master : CTkFrame</span>
<span class="sd">            the master frame for the helpForParameters tab</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dataTabModel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataTabController</span><span class="o">.</span><span class="n">getModel</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">helpForParametersTabController</span> <span class="o">=</span> <span class="n">HelpForParametersTabController</span><span class="p">(</span><span class="n">master</span><span class="p">,</span> <span class="n">dataTabModel</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">prometheeGamma</span><span class="p">,</span> <span class="n">lock</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lock</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">helpForParametersTabController</span><span class="o">.</span><span class="n">setListener</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">helpForParametersTabController</span><span class="o">.</span><span class="n">showView</span><span class="p">()</span></div>


<div class="viewcode-block" id="AppController.obtainResults"><a class="viewcode-back" href="../../../promethee_gamma_gui.Controllers.html#promethee_gamma_gui.Controllers.AppController.AppController.obtainResults">[docs]</a>    <span class="k">def</span> <span class="nf">obtainResults</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">load</span><span class="p">:</span><span class="nb">bool</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Obtain the results or, if there is no or not enought data, show an error message to the user</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        load : bool</span>
<span class="sd">            True if the resut visualisation must be loaded, False otherwise</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataTabController</span><span class="o">.</span><span class="n">voidModel</span><span class="p">():</span>
            <span class="n">msg</span><span class="o">.</span><span class="n">showerror</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;No data&quot;</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="s2">&quot;No data available. Impossible to obtain results. Please fill in the data tab&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataTabController</span><span class="o">.</span><span class="n">no2AlterInModel</span><span class="p">():</span>
            <span class="n">msg</span><span class="o">.</span><span class="n">showerror</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Not enougth alternatives&quot;</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="s2">&quot;At least 2 alternatives are needed to obtain results. Please, add alternatives.&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">load</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">resultTabController</span><span class="o">.</span><span class="n">loadResultsVisualisation</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">computeResults</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lock</span><span class="o">.</span><span class="n">unlock</span><span class="p">()</span></div>


<div class="viewcode-block" id="AppController.computeResults"><a class="viewcode-back" href="../../../promethee_gamma_gui.Controllers.html#promethee_gamma_gui.Controllers.AppController.AppController.computeResults">[docs]</a>    <span class="k">def</span> <span class="nf">computeResults</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute the result of the Promethee Gamma method</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">alreadyCompute</span><span class="p">:</span>
            <span class="n">dataTabModel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataTabController</span><span class="o">.</span><span class="n">getModel</span><span class="p">()</span>
            <span class="n">resultTabModel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">resultTabController</span><span class="o">.</span><span class="n">getModel</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">prometheeGamma</span><span class="o">.</span><span class="n">setDataTabModel</span><span class="p">(</span><span class="n">dataTabModel</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">prometheeGamma</span><span class="o">.</span><span class="n">setResultTabModel</span><span class="p">(</span><span class="n">resultTabModel</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">alreadyCompute</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prometheeGamma</span><span class="o">.</span><span class="n">computeAll</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">resultTabController</span><span class="o">.</span><span class="n">refreshResultsVisualisation</span><span class="p">()</span></div>


<div class="viewcode-block" id="AppController.changeOnTiAndTj"><a class="viewcode-back" href="../../../promethee_gamma_gui.Controllers.html#promethee_gamma_gui.Controllers.AppController.AppController.changeOnTiAndTj">[docs]</a>    <span class="k">def</span> <span class="nf">changeOnTiAndTj</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Recompute the needed results in case of change on Ti and Tj</span>
<span class="sd">        </span>
<span class="sd">        This method must be called if there is a simultaneous change of the thresholds Ti and Tj</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">alreadyCompute</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">prometheeGamma</span><span class="o">.</span><span class="n">computeMatrixI</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">prometheeGamma</span><span class="o">.</span><span class="n">computeMatrixJ</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">prometheeGamma</span><span class="o">.</span><span class="n">computeMatrixResults</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">resultTabController</span><span class="o">.</span><span class="n">refreshResultsVisualisation</span><span class="p">()</span></div>


<div class="viewcode-block" id="AppController.changeOnTi"><a class="viewcode-back" href="../../../promethee_gamma_gui.Controllers.html#promethee_gamma_gui.Controllers.AppController.AppController.changeOnTi">[docs]</a>    <span class="k">def</span> <span class="nf">changeOnTi</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Recompute the needed results in case of change on Ti</span>

<span class="sd">        This method must be called if there is a change of the threshold Ti and not on Tj</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">alreadyCompute</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">prometheeGamma</span><span class="o">.</span><span class="n">computeMatrixI</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">prometheeGamma</span><span class="o">.</span><span class="n">computeMatrixResults</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">resultTabController</span><span class="o">.</span><span class="n">refreshResultsVisualisation</span><span class="p">()</span></div>


<div class="viewcode-block" id="AppController.changeOnTj"><a class="viewcode-back" href="../../../promethee_gamma_gui.Controllers.html#promethee_gamma_gui.Controllers.AppController.AppController.changeOnTj">[docs]</a>    <span class="k">def</span> <span class="nf">changeOnTj</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Recompute the needed results in case of change on Tj</span>

<span class="sd">        This method must be called if there is a change of the threshold Tj and not on Ti</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">alreadyCompute</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">prometheeGamma</span><span class="o">.</span><span class="n">computeMatrixJ</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">prometheeGamma</span><span class="o">.</span><span class="n">computeMatrixResults</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">resultTabController</span><span class="o">.</span><span class="n">refreshResultsVisualisation</span><span class="p">()</span></div>


<div class="viewcode-block" id="AppController.changeOnPf"><a class="viewcode-back" href="../../../promethee_gamma_gui.Controllers.html#promethee_gamma_gui.Controllers.AppController.AppController.changeOnPf">[docs]</a>    <span class="k">def</span> <span class="nf">changeOnPf</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Recompute the needed results in case of change on Pf</span>

<span class="sd">        This method must be called if there is a change of the parameter Pf</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">alreadyCompute</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">prometheeGamma</span><span class="o">.</span><span class="n">computeMatrixP</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">prometheeGamma</span><span class="o">.</span><span class="n">computeMatrixResults</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">resultTabController</span><span class="o">.</span><span class="n">refreshResultsVisualisation</span><span class="p">()</span></div>


<div class="viewcode-block" id="AppController.getPrometheeGammaModel"><a class="viewcode-back" href="../../../promethee_gamma_gui.Controllers.html#promethee_gamma_gui.Controllers.AppController.AppController.getPrometheeGammaModel">[docs]</a>    <span class="k">def</span> <span class="nf">getPrometheeGammaModel</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PrometheeGamma</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the current used model for the Promethee Gamma method</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        PrometheeGamma</span>
<span class="sd">            the current used model for the Promethee Gamma method</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">prometheeGamma</span></div>
    

<div class="viewcode-block" id="AppController.getDataTabModel"><a class="viewcode-back" href="../../../promethee_gamma_gui.Controllers.html#promethee_gamma_gui.Controllers.AppController.AppController.getDataTabModel">[docs]</a>    <span class="k">def</span> <span class="nf">getDataTabModel</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the current data tab model</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        DataTabModel</span>
<span class="sd">            the current data tab model</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataTabController</span><span class="o">.</span><span class="n">getModel</span><span class="p">()</span></div>
    

<div class="viewcode-block" id="AppController.applyResultsOfHelp"><a class="viewcode-back" href="../../../promethee_gamma_gui.Controllers.html#promethee_gamma_gui.Controllers.AppController.AppController.applyResultsOfHelp">[docs]</a>    <span class="k">def</span> <span class="nf">applyResultsOfHelp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">results</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Apply the results obtained in the helpForParameters tab in the result tab</span>

<span class="sd">        i.e. modify the values of Ti, Tj and Pf in the result tab accordingly to their values in the helpForParameters tab</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        results : tuple of float</span>
<span class="sd">            results = (Ti, Tj, Pf), the values of the 3 parameters of PROMETHEE Gamma method</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">resultTabController</span><span class="o">.</span><span class="n">applyResults</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">appView</span><span class="o">.</span><span class="n">setTab</span><span class="p">(</span><span class="s2">&quot;Results&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="AppController.menuChoice"><a class="viewcode-back" href="../../../promethee_gamma_gui.Controllers.html#promethee_gamma_gui.Controllers.AppController.AppController.menuChoice">[docs]</a>    <span class="k">def</span> <span class="nf">menuChoice</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">choice</span><span class="p">:</span><span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Handle the choice made by the user in the Project menu</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        choice : str</span>
<span class="sd">            the choice made by the user. It can be &quot;new&quot;, &quot;save as&quot;, &quot;save&quot; or &quot;load&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">choice</span> <span class="o">==</span> <span class="s2">&quot;new&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">msg</span><span class="o">.</span><span class="n">askokcancel</span><span class="p">(</span><span class="s2">&quot;Create a new project&quot;</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="s2">&quot;Do you really want to create a new project? All unsaved data will be lost.&quot;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">choice</span> <span class="o">==</span> <span class="s2">&quot;save as&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">saveAs</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">choice</span> <span class="o">==</span> <span class="s2">&quot;save&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">choice</span> <span class="o">==</span> <span class="s2">&quot;load&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">msg</span><span class="o">.</span><span class="n">askokcancel</span><span class="p">(</span><span class="s2">&quot;Load a project&quot;</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="s2">&quot;Do you really want to load a project? All unsaved data will be lost.&quot;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">load</span><span class="p">()</span></div>


<div class="viewcode-block" id="AppController.menuHelp"><a class="viewcode-back" href="../../../promethee_gamma_gui.Controllers.html#promethee_gamma_gui.Controllers.AppController.AppController.menuHelp">[docs]</a>    <span class="k">def</span> <span class="nf">menuHelp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">choice</span><span class="p">:</span><span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Show the help corresponding to choice</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        choice : str</span>
<span class="sd">            the choice made by the user. </span>
<span class="sd">            It can be &quot;Data&quot;, &quot;Parameters&quot;, &quot;Matrix&quot;, &quot;Orthogonal graph&quot;, &quot;Rank graph&quot;, &quot;Preference learning&quot; or &quot;Custom&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">helpController</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">choice</span><span class="p">)</span></div>

    
<div class="viewcode-block" id="AppController.quit"><a class="viewcode-back" href="../../../promethee_gamma_gui.Controllers.html#promethee_gamma_gui.Controllers.AppController.AppController.quit">[docs]</a>    <span class="k">def</span> <span class="nf">quit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Quit the app</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">msg</span><span class="o">.</span><span class="n">askokcancel</span><span class="p">(</span><span class="s2">&quot;Quit&quot;</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="s2">&quot;Do you really want to quit? All unsaved data will be lost.&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">appView</span><span class="o">.</span><span class="n">quit</span><span class="p">()</span>
            <span class="n">exit</span><span class="p">()</span></div>


<div class="viewcode-block" id="AppController.about"><a class="viewcode-back" href="../../../promethee_gamma_gui.Controllers.html#promethee_gamma_gui.Controllers.AppController.AppController.about">[docs]</a>    <span class="k">def</span> <span class="nf">about</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Show about window</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">r</span> <span class="o">=</span> <span class="n">Reader</span><span class="p">()</span>
            <span class="n">text</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">readTxt</span><span class="p">(</span><span class="s2">&quot;./promethee_gamma_gui/Files/About.txt&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
            <span class="n">msg</span><span class="o">.</span><span class="n">showerror</span><span class="p">(</span><span class="s2">&quot;Error&quot;</span><span class="p">,</span> <span class="s2">&quot;The resource could not be loaded, a file is missing.&quot;</span><span class="p">)</span>
            <span class="k">return</span> 
        <span class="n">aboutView</span> <span class="o">=</span> <span class="n">AboutView</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">fg_color</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">platform</span><span class="o">.</span><span class="n">system</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;Windows&#39;</span><span class="p">:</span>
            <span class="n">aboutView</span><span class="o">.</span><span class="n">grab_set</span><span class="p">()</span>
            <span class="n">aboutView</span><span class="o">.</span><span class="n">focus_set</span><span class="p">()</span></div>



<div class="viewcode-block" id="AppController.reset"><a class="viewcode-back" href="../../../promethee_gamma_gui.Controllers.html#promethee_gamma_gui.Controllers.AppController.AppController.reset">[docs]</a>    <span class="k">def</span> <span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Reset all the app</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alreadyCompute</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_parentDirectory</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_nameDirectory</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">helpForParametersTabController</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">resultTabController</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prometheeGamma</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dataTabController</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">appView</span><span class="o">.</span><span class="n">setTab</span><span class="p">(</span><span class="s2">&quot;Data&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lock</span><span class="o">.</span><span class="n">unlock</span><span class="p">()</span></div>
        

<div class="viewcode-block" id="AppController.save"><a class="viewcode-back" href="../../../promethee_gamma_gui.Controllers.html#promethee_gamma_gui.Controllers.AppController.AppController.save">[docs]</a>    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Save the project</span>

<span class="sd">        If a folder is already linked to the project, save the project in this folder. Otherwise, call saveAs.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">save_parentDirectory</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">save_nameDirectory</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">save_parentDirectory</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">save_nameDirectory</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">saveAs</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">msg</span><span class="o">.</span><span class="n">askokcancel</span><span class="p">(</span><span class="s2">&quot;directory selection&quot;</span><span class="p">,</span> <span class="s2">&quot;The content of the directory will be overwrite. Use this directory?</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">save_parentDirectory</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">save_nameDirectory</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">saveProject</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">msg</span><span class="o">.</span><span class="n">showwarning</span><span class="p">(</span><span class="s2">&quot;Warning&quot;</span><span class="p">,</span> <span class="s2">&quot;The project was not saved.&quot;</span><span class="p">)</span></div>

        
<div class="viewcode-block" id="AppController.saveAs"><a class="viewcode-back" href="../../../promethee_gamma_gui.Controllers.html#promethee_gamma_gui.Controllers.AppController.AppController.saveAs">[docs]</a>    <span class="k">def</span> <span class="nf">saveAs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Show the saveView</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">saveView</span> <span class="o">=</span> <span class="n">SaveView</span><span class="p">(</span><span class="n">master</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">appView</span><span class="p">,</span> <span class="n">saveDict</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">saveDict</span><span class="p">,</span> <span class="n">parentDirectory</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">save_parentDirectory</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">save_nameDirectory</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">platform</span><span class="o">.</span><span class="n">system</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;Windows&#39;</span><span class="p">:</span>
            <span class="n">saveView</span><span class="o">.</span><span class="n">grab_set</span><span class="p">()</span>
            <span class="n">saveView</span><span class="o">.</span><span class="n">focus_set</span><span class="p">()</span>
        <span class="n">saveView</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Save&quot;</span><span class="p">)</span>
        <span class="n">saveView</span><span class="o">.</span><span class="n">setListener</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">saveView</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>


<div class="viewcode-block" id="AppController.saveInDirectory"><a class="viewcode-back" href="../../../promethee_gamma_gui.Controllers.html#promethee_gamma_gui.Controllers.AppController.AppController.saveInDirectory">[docs]</a>    <span class="k">def</span> <span class="nf">saveInDirectory</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">directory</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">view</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Save the project in a new directory of name &quot;name&quot; located in &quot;directory&quot;</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        directory : str</span>
<span class="sd">            the directory in which to save the project</span>
<span class="sd">        name : str</span>
<span class="sd">            the name of the project and so the name of the project directory</span>
<span class="sd">        view : SaveView, a CTkTopLevel</span>
<span class="sd">            the save view</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">view</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span>

        <span class="n">newdirectory</span> <span class="o">=</span> <span class="n">directory</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="n">name</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">newdirectory</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">newdirectory</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">save_parentDirectory</span> <span class="o">=</span> <span class="n">directory</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">save_nameDirectory</span> <span class="o">=</span> <span class="n">name</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">msg</span><span class="o">.</span><span class="n">askokcancel</span><span class="p">(</span><span class="s2">&quot;The directory already exists&quot;</span><span class="p">,</span> <span class="s2">&quot;Do you want to overwrite the contents of the directory?&quot;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">save_parentDirectory</span> <span class="o">=</span> <span class="n">directory</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">save_nameDirectory</span> <span class="o">=</span> <span class="n">name</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">msg</span><span class="o">.</span><span class="n">showwarning</span><span class="p">(</span><span class="s2">&quot;Warning&quot;</span><span class="p">,</span> <span class="s2">&quot;The project was not saved.&quot;</span><span class="p">)</span>
                <span class="k">return</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">saveProject</span><span class="p">()</span></div>


<div class="viewcode-block" id="AppController.saveProject"><a class="viewcode-back" href="../../../promethee_gamma_gui.Controllers.html#promethee_gamma_gui.Controllers.AppController.AppController.saveProject">[docs]</a>    <span class="k">def</span> <span class="nf">saveProject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Save the selected project components</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">directory</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">save_parentDirectory</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">save_nameDirectory</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">saveDict</span><span class="p">[</span><span class="s2">&quot;Data&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dataTabController</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">saveDict</span><span class="p">[</span><span class="s2">&quot;Results&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">saveResults</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">saveDict</span><span class="p">[</span><span class="s2">&quot;Orthogonal graph&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">resultTabController</span><span class="o">.</span><span class="n">saveOgraph</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">saveDict</span><span class="p">[</span><span class="s2">&quot;Rank graph&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">resultTabController</span><span class="o">.</span><span class="n">saveRgraph</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span>

        <span class="n">msg</span><span class="o">.</span><span class="n">showinfo</span><span class="p">(</span><span class="s2">&quot;Save complete&quot;</span><span class="p">,</span> <span class="s2">&quot;The project has been successfully saved.&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="AppController.saveResults"><a class="viewcode-back" href="../../../promethee_gamma_gui.Controllers.html#promethee_gamma_gui.Controllers.AppController.AppController.saveResults">[docs]</a>    <span class="k">def</span> <span class="nf">saveResults</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">directory</span><span class="p">:</span><span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Save results in directory</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        directory : str</span>
<span class="sd">            the directory in which to save results </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">directory</span> <span class="o">+</span> <span class="s2">&quot;/Results.txt&quot;</span>
        <span class="n">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">resultTabController</span><span class="o">.</span><span class="n">saveParameters</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">Results matrix</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fileWriteMatrix</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">prometheeGamma</span><span class="o">.</span><span class="n">getMatrixResults</span><span class="p">())</span>
        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">Gamma matrix</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fileWriteMatrix</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">prometheeGamma</span><span class="o">.</span><span class="n">getMatrixGamma</span><span class="p">())</span>
        <span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>


<div class="viewcode-block" id="AppController.fileWriteMatrix"><a class="viewcode-back" href="../../../promethee_gamma_gui.Controllers.html#promethee_gamma_gui.Controllers.AppController.AppController.fileWriteMatrix">[docs]</a>    <span class="k">def</span> <span class="nf">fileWriteMatrix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file</span><span class="p">,</span> <span class="n">m</span><span class="p">:</span><span class="nb">list</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Write the matrix &quot;m&quot; in file &quot;file&quot;</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        file : io</span>
<span class="sd">            the file in which to write the matrix</span>
<span class="sd">        m : list of list of (float or str)</span>
<span class="sd">            a matrix</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">m</span><span class="p">)):</span>
            <span class="n">line</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])):</span>
                <span class="n">line</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;  &quot;</span>
            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">line</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="AppController.load"><a class="viewcode-back" href="../../../promethee_gamma_gui.Controllers.html#promethee_gamma_gui.Controllers.AppController.AppController.load">[docs]</a>    <span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Load a PROMETHEE Gamma project</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="s2">&quot;../Projects&quot;</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="s2">&quot;../Projects&quot;</span><span class="p">)</span>
        <span class="n">directory</span> <span class="o">=</span> <span class="n">fd</span><span class="o">.</span><span class="n">askdirectory</span><span class="p">(</span><span class="n">initialdir</span><span class="o">=</span><span class="s2">&quot;../Projects&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">directory</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span> <span class="c1"># Reset the app</span>

            <span class="n">d</span> <span class="o">=</span> <span class="n">directory</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">save_nameDirectory</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">save_parentDirectory</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">save_parentDirectory</span> <span class="o">+=</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

            <span class="n">tabs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">appView</span><span class="o">.</span><span class="n">getTabs</span><span class="p">()</span>
            <span class="n">datafile</span> <span class="o">=</span> <span class="n">directory</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="s2">&quot;Data.csv&quot;</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">datafile</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">dataTabController</span><span class="o">.</span><span class="n">loadData</span><span class="p">(</span><span class="n">datafile</span><span class="p">,</span> <span class="n">tabs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="n">msg</span><span class="o">.</span><span class="n">showerror</span><span class="p">(</span><span class="s2">&quot;Error&quot;</span><span class="p">,</span> <span class="s2">&quot;An error has occurred: unable to load correclty the project&quot;</span><span class="p">)</span>
                    <span class="k">return</span>

                <span class="n">resultfile</span> <span class="o">=</span> <span class="n">directory</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="s2">&quot;Results.txt&quot;</span>
                <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">resultfile</span><span class="p">):</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">resultTabController</span><span class="o">.</span><span class="n">loadResults</span><span class="p">(</span><span class="n">resultfile</span><span class="p">)</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="n">msg</span><span class="o">.</span><span class="n">showerror</span><span class="p">(</span><span class="s2">&quot;Error&quot;</span><span class="p">,</span> <span class="s2">&quot;An error has occurred: unable to load correclty the project&quot;</span><span class="p">)</span>
                        <span class="k">return</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">msg</span><span class="o">.</span><span class="n">showerror</span><span class="p">(</span><span class="s2">&quot;No data found&quot;</span><span class="p">,</span> <span class="s2">&quot;The project could not be loaded.&quot;</span><span class="p">)</span>
                <span class="k">return</span>
            
            <span class="n">msg</span><span class="o">.</span><span class="n">showinfo</span><span class="p">(</span><span class="s2">&quot;Load&quot;</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="s2">&quot;The project has been successfully loaded.&quot;</span><span class="p">)</span></div></div>
</pre></div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../../index.html">PROMETHEE Gamma GUI app</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../modules.html">src</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../index.html">Documentation overview</a><ul>
  <li><a href="../../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, Luka BONHEURE.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.0.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
    </div>

    

    
  </body>
</html>